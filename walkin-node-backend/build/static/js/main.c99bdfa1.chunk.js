(this.webpackJsonpkartta=this.webpackJsonpkartta||[]).push([[0],{117:function(e,t,a){e.exports=a(139)},122:function(e,t,a){},139:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(15),c=a.n(r),o=(a(122),a(86),a(49)),i=a.n(o),s=a(59),u=a(16);function m(){var e=new Date;return e.setDate(e.getDate()+0),e.toISOString().substr(0,10)}function d(e){var t=l.a.useState(0),a=Object(u.a)(t,2),n=a[0],r=a[1],c=e.loading;return"LOADING"!==c||e.loaded||setTimeout((function(){r(n+1)}),1e3),n<30?l.a.createElement("div",null,c):l.a.createElement("div",null,"Something isn't right :(")}var E=a(29),v=a.n(E);function g(e){for(var t=function(e,t,a){var n=e[t];e[t]=e[a],e[a]=n},a=0;a<e.length-1;a++)for(var n=0;n<e.length-a-1;n++)e[n].event_dates.starting_day>e[n+1].event_dates.starting_day&&t(e,n,n+1);return e}function f(e,t){var a=[];return 0!==t&&void 0!==e?(e.map((function(e){if(v()(e.event_dates.starting_day).format("DD.MM.YYYY")===v()(t).format("DD.MM.YYYY")){var n=new Date;if(n.setDate(n.getDate()+0),n.toISOString().substr(0,10)===t){var l=new Date(e.event_dates.starting_day),r=new Date(e.event_dates.ending_day),c=(new Date).getTime(),o=new Date;o=(o=l-c)/1e3/60/60;var i=new Date;i=(i=r-c)/1e3/60/60,(o>0&&o<3||o<0&&i>0)&&a.push(e)}else a.push(e)}})),a=g(a)):e}function p(e,t){var a=e,n=[];return 0!==t?(a=e.map((function(e,a){var l=e.name.fi;null===l&&(l=e.name.en),null===l&&(l=e.name.sv),l=l.toLowerCase(),t=t.toLowerCase(),!0===l.includes(t)&&n.push(e)})),n=g(n)):a}function h(e){var t=[],a=function(e){var t=[];if(void 0===e)return t;t=e,console.log(t)}();if(a.forEach((function(e){return console.log(e)})),a.forEach((function(e){return console.log(e.value)})),Array.isArray(a)&&0===a.length)return e;return e.forEach((function(e){(function(e){var t=!1;e.tags.some((function(e){return a.includes(e.name)}))&&(t=!0);return t})(e)&&t.push(e)})),t}function y(e){var t=e.events;t=p(f(e.events,e.selectedDay),e.event),0===e.event&&0===e.selectedDay&&(t=e.event);var a;return a=(t=h(t)).map((function(e,t){var a=e.name.fi,n=e.event_dates.ending_day,r=e.location.lon,c=e.location.lat;null===a&&(a=e.name.en),null===a&&(a=e.name.sv);var o=new Date(e.event_dates.starting_day);o=v()(o).format("HH:mm");var i=new Date(n);return i=v()(i).format("HH:mm"),l.a.createElement("tr",{key:t},l.a.createElement("td",null,t),l.a.createElement("td",null),l.a.createElement("td",{width:500},a),l.a.createElement("td",null,e.location.address.street_address," "),l.a.createElement("td",null,e.location.address.postal_code," "),l.a.createElement("td",null,e.location.address.locality," "),l.a.createElement("td",null,v()(e.event_dates.starting_day).format("DD.MM.YYYY")," ",o),l.a.createElement("td",null," "),l.a.createElement("td",null,v()(n).format("DD.MM.YYYY")," ",i," "),l.a.createElement("td",null," "),l.a.createElement("td",null,r.toFixed(7)),l.a.createElement("td",null,c.toFixed(7)))})),0===t.length?l.a.createElement("div",null,"Sorry, no events were found."):l.a.createElement("div",{className:"App"},l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"index"),l.a.createElement("th",null),l.a.createElement("th",null,"name"),l.a.createElement("th",null,"address"),l.a.createElement("th",null,"zipcode"),l.a.createElement("th",null,"city"),l.a.createElement("th",null,"startingday"),l.a.createElement("th",null),l.a.createElement("th",null,"endingday"),l.a.createElement("th",null),l.a.createElement("th",null,"longitude"),l.a.createElement("th",null,"latitude"))),l.a.createElement("tbody",null,a)))}var b=a(80),O=a(113);var S=a(23);function T(e){return{type:"ADD_TAG",tag:e}}function j(e){return{type:"SET_CHOSEN_TAGS",tags:e}}function w(e){var t=Object(S.c)();Object(S.b)();var a=Object(O.a)(),n=t.getState().allTags;return l.a.createElement("div",null,l.a.createElement(b.a,{closeMenuOnSelect:!1,options:n,components:a,isMulti:!0,onChange:function(e){t.dispatch(j(e)),console.log(t.getState().chosenTags)}}))}var _=a(89),D=a(92),k=a(90),x=a(91),A=a(88),C=(a(129),a(4)),Y=a.n(C),M=a(97),N=a.n(M),I=a(98),L=a.n(I),B=a(99),W=a.n(B),F=a(101),G=a(38),H=a(30),R=a(39),z=a(22),J=function(e){var t=l.a.useState(15),a=Object(u.a)(t,2),n=a[0],r=(a[1],{lat:e.latitude,lng:e.longitude}),c=Object(F.renderToStaticMarkup)(l.a.createElement("span",{style:{color:"Tomato"}},l.a.createElement("i",{className:"fas fa-street-view fa-3x"}))),o=Object(C.divIcon)({html:c}),i=(e.events,p(f(e.events,e.selectedDay),e.event)),s=Y.a.icon({iconUrl:N.a,shadowUrl:L.a});return Y.a.Marker.prototype.options.icon=s,l.a.createElement(_.a,{center:r,zoom:n},l.a.createElement(D.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),l.a.createElement(W.a,null,i.map((function(e,t){return l.a.createElement(k.a,{key:t,position:[e.location.lat,e.location.lon]},l.a.createElement(x.a,{minWidth:"500"},l.a.createElement(z.a,null,l.a.createElement(z.a.Body,null,l.a.createElement(G.a,{style:{paddingBottom:20}},l.a.createElement(H.a,{xs:12,md:6},l.a.createElement(z.a.Title,null,e.name.fi),l.a.createElement(z.a.Text,null,l.a.createElement("p",null,e.description.intro),l.a.createElement("p",null,e.location.address.locality),l.a.createElement("p",null,"Osoite: ",e.location.address.street_address),l.a.createElement("p",null,"Pvm ja aloitusaika ",v()("".concat(e.event_dates.starting_day)).format("DD.MM.YYYY HH:mm")),l.a.createElement("p",null,"Et\xe4isyys: ",Y.a.latLng(r.lat,r.lng).distanceTo(Y.a.latLng(e.location.lat,e.location.lon)).toFixed(0)," m")))),l.a.createElement(G.a,null,l.a.createElement(H.a,{xs:6},l.a.createElement(R.a,{variant:"primary",style:{marginRight:10}},"Show more"),l.a.createElement(R.a,{href:e.info_url,target:"_blank",variant:"secondary"},"WWW")))))))}))),l.a.createElement(k.a,{key:1,position:[r.lat,r.lng],icon:o}),l.a.createElement(A.a,{center:[r.lat,r.lng],radius:1e3*e.area}))},K=a(142),U=(a(133),a(102)),V=a.n(U);var P=function(e){return l.a.createElement(V.a,{min:"1",max:"20",size:"lg",value:e.area,area:e.area,onChange:function(t){return e.HandleSlider(t.target.value)}})};function $(e){var t,a,r=Object(n.useState)(e.selectedDay),c=Object(u.a)(r,2),o=c[0],i=c[1],s=Object(n.useState)(e.event),d=Object(u.a)(s,2),E=d[0],v=d[1],g=Object(n.useState)(1),f=Object(u.a)(g,2),p=f[0],h=f[1],y=Object(n.useState)(!1),b=Object(u.a)(y,2),O=b[0],S=b[1],T=function(){e.ShowFilters(o,E,p),S(!1)};return a=0===E?"event":E,l.a.createElement("div",null,l.a.createElement(R.a,{style:{margin:10},variant:"primary",onClick:function(){S(!0)}},"Filters"),l.a.createElement(K.a,{show:O,onClose:T},l.a.createElement(K.a.Header,null,l.a.createElement(K.a.Title,null,"Filters")),l.a.createElement(K.a.Body,null,l.a.createElement("div",{className:"App"},l.a.createElement("p",null,"name: ",l.a.createElement("input",{id:"eventos",placeholder:a,onChange:function(e){(t=e.target.value).length>2&&v(t),t.length<1&&v(0)}})),l.a.createElement("p",null,"date: ",l.a.createElement("input",{id:"selectday",type:"date",value:o,onChange:function(e){i(e.target.value)}})),l.a.createElement(P,{HandleSlider:function(e){h(e)},area:p}))),l.a.createElement(K.a.Footer,null,l.a.createElement(R.a,{variant:"danger",onClick:function(){i(m()),v(0),document.getElementById("eventos").value="",document.getElementById("selectday").value="",h(1)}},"Reset"),l.a.createElement(R.a,{variant:"secondary",onClick:function(){document.getElementById("eventos").value="",document.getElementById("selectday").value="",S(!1)}},"Cancel"),l.a.createElement(R.a,{variant:"primary",onClick:T},"Search"))))}function q(e,t,a){return Q.apply(this,arguments)}function Q(){return(Q=Object(s.a)(i.a.mark((function e(t,a,n){var l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=[],void 0===t||void 0===a){e.next=4;break}return e.next=4,fetch("api/events/?distance_filter="+t+"%2C"+a+"%2C"+n).then((function(e){if(e.ok)return e.json();throw new Error("Something went wrong ...")})).then((function(e){l=JSON.parse(e)})).catch((function(e){return console.error(e)}));case 4:return e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(){var e=Object(S.c)();Object(S.b)();var t=l.a.useState(""),a=Object(u.a)(t,2),r=a[0],c=a[1],o=l.a.useState(0),E=Object(u.a)(o,2),v=E[0],g=E[1],f=l.a.useState(0),p=Object(u.a)(f,2),h=p[0],b=p[1],O=l.a.useState("LOADING"),T=Object(u.a)(O,2),j=T[0],_=T[1],D=Object(n.useState)(!1),k=Object(u.a)(D,2),x=k[0],A=k[1],C=Object(n.useState)(),Y=Object(u.a)(C,2),M=Y[0],N=Y[1],I=Object(n.useState)(),L=Object(u.a)(I,2),B=L[0],W=L[1],F=Object(n.useState)(1),G=Object(u.a)(F,2),H=G[0],R=G[1];function z(e,t,a){return K.apply(this,arguments)}function K(){return(K=Object(s.a)(i.a.mark((function e(t,a,n){var l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=q(t,a,n),e.t0=c,e.next=4,l;case 4:e.t1=e.sent,(0,e.t0)(e.t1),""!==r&&(_(""),A(!0));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(n.useEffect)((function(){U()}),[B,M]);var U=function(){navigator.geolocation.getCurrentPosition((function(t){N(t.coords.latitude),W(t.coords.longitude),e.dispatch(function(e,t){return{type:"SET_USER_LOCATION",location:{latitude:e,longitude:t}}}(t.coords.latitude,t.coords.longitude))}));var t=M,a=B,n=m();g(n),z(t,a,H)};return"LOADING"!==j||x?l.a.createElement("div",{className:"App"},l.a.createElement("h1",null,"\xa0"),l.a.createElement($,{ShowFilters:function(e,t,a){(a=parseInt(a),void 0!==e&&g(e),void 0!==t&&b(t),H!==a)&&(R(a),z(M,B,a),_("LOADING"))},selectedDay:v,event:h}),l.a.createElement(J,{latitude:M,longitude:B,events:r,event:h,area:H,selectedDay:v}),l.a.createElement(w,{events:r}),"area:",H,"km",l.a.createElement(d,{loading:j,loaded:x}),l.a.createElement(y,{events:r,event:h,selectedDay:v})):l.a.createElement("div",{className:"App"},l.a.createElement("h1",null,"\xa0"),l.a.createElement(d,{loading:j,loaded:x}))}var Z=a(143),ee=a(115),te=function(){return l.a.createElement(Z.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},l.a.createElement(Z.a.Brand,{href:"/Index"},"WalkInEvents"),l.a.createElement(Z.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),l.a.createElement(Z.a.Collapse,{id:"responsive-navbar-nav"},l.a.createElement(ee.a,{className:"mr-auto"})))},ae=a(114),ne=a(76),le=a(109);function re(){var e=["One","Two","Three","Four"].map((function(e,t){var a=e,n="date&time "+(t+1),r="place "+(t+1),c="address "+(t+1),o=100*(t+1)+" m";return l.a.createElement(z.a,{key:t,style:{marginTop:10},bg:"light"},l.a.createElement(z.a.Body,null,l.a.createElement(G.a,{style:{paddingBottom:20}},l.a.createElement(H.a,null,l.a.createElement(z.a.Title,null,a),l.a.createElement(z.a.Text,null,n,l.a.createElement("br",null),r,l.a.createElement("br",null),c))),l.a.createElement(G.a,null,l.a.createElement(H.a,{xs:6},o),l.a.createElement(H.a,{xs:6},l.a.createElement(R.a,{variant:"primary",style:{marginRight:10}},"Show more"),l.a.createElement(R.a,{variant:"secondary"},"WWW")))))}));return l.a.createElement("div",null,l.a.createElement(z.a,null,l.a.createElement(z.a.Body,null,l.a.createElement(G.a,{style:{paddingBottom:20}},l.a.createElement(H.a,{xs:12,md:6},l.a.createElement(z.a.Title,null,"John Bishop Live"),l.a.createElement(z.a.Text,null,"20.10.2020 19:30",l.a.createElement("br",null),"Hall of Culture",l.a.createElement("br",null),"Sturenkatu 4 00510 Helsinki"))),l.a.createElement(G.a,null,l.a.createElement(H.a,{xs:6},"300 m"),l.a.createElement(H.a,{xs:6},l.a.createElement(R.a,{variant:"primary",style:{marginRight:10}},"Show more"),l.a.createElement(R.a,{variant:"secondary"},"WWW"))))),e)}var ce=function(){return l.a.createElement(le.a,null,l.a.createElement(re,null))};function oe(){var e=Object(S.c)();return Object(S.b)(),console.log("Running redux tests"),console.log(e.getState()),e.dispatch({type:"ADD_TAG",tag:"uusitagi1"}),console.log(T("uusitagi2")),e.dispatch(T("uusitagi2")),e.dispatch({type:"REMOVE_TAG",tag:"Testitagi1"}),console.log("state on",e.getState()),e.dispatch(j(["SetTag1","SetTag2","SetTag3"])),console.log(e.getState().chosenTags),"Tests here"}var ie=function(){return l.a.createElement(ae.a,{defaultActiveKey:"map",id:"uncontrolled-tab-example"},l.a.createElement(ne.a,{eventKey:"map",title:"Map"},l.a.createElement(X,null)),l.a.createElement(ne.a,{eventKey:"list",title:"List"},l.a.createElement(ce,null)),l.a.createElement(ne.a,{eventKey:"tests",title:"Tests"},l.a.createElement(oe,null)))};var se=a(110),ue=a(13);function me(){return l.a.createElement("div",null,l.a.createElement(se.a,null,l.a.createElement(te,null),l.a.createElement(ie,null),l.a.createElement(ue.b,null)))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var de=a(52),Ee=a(112),ve={range:3,chosenTags:[],allTags:[{value:"Teatteri",label:"Teatteri"},{value:"Tanssi",label:"Tanssi"},{value:"General",label:"General"}],filteredEvents:[],allEvents:[],userLocation:{},selectedTime:{},timeNow:m(),selectedFilters:{timeFilter:!0,tagFilter:!0,locationFilter:!0}};var ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(console.log(e),t.type){case"ADD_TAG":return Object.assign({},e,{chosenTags:[].concat(Object(Ee.a)(e.chosenTags),[t.tag])});case"REMOVE_TAG":var a=e.chosenTags.filter((function(e){return e!=t.tag}));return Object.assign({},e,{chosenTags:[a]});case"SET_CHOSEN_TAGS":return Object.assign({},e,{chosenTags:t.tags});case"SET_TIME_NOW":return Object.assign({},e,{timeNow:t.time});case"SET_USER_LOCATION":return Object.assign({},e,{userLocation:t.location});case"SET_ALL_EVENTS":return Object.assign({},e,{allEvents:t.events});default:return ve}},fe=(a(138),Object(de.b)(ge));c.a.render(l.a.createElement(S.a,{store:fe},l.a.createElement(me,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},86:function(e,t,a){}},[[117,1,2]]]);
//# sourceMappingURL=main.c99bdfa1.chunk.js.map